<!DOCTYPE html>
<html ng-app="simpleTest">

<!--http://jmcunningham.net/2014/08/09/angularjs-using-setviewvalue-and-render-to-update-models-forms/-->
<head>

    <meta charset="utf-8" />

    <title>
        Experimenting With ngModel And ngModelController In AngularJS
    </title>

    <link rel="stylesheet" href="../bootstrap.min.css" />
    <script src="../jquery.js"></script>
    <script src="../angular.js"></script>
    <script src="../bootstrap.min.js"></script>
    <script>

        // Code goes here
        angular.module('simpleTest', [])
                .controller('MyCtrl', function() {
                    var self = this;

                    /*
                     * Loop through a list of element ids, calling the $render() function for
                     * the ngModel controller associated with each element.
                     */
                    function renderElement(elementIds) {
                        angular.forEach(elementIds, function(id) {
                            angular.element(id).controller('ngModel').$render();
                        });
                    }

                    //set default values for the initial page render
                    self.location = {
                        city: 'Nashville',
                        state: 'Tennessee',
                        zip: '37210'
                    };

                    self.updateModel = function updateModel() {
                        // update the form values
                        self.simpleForm.city.$setViewValue('Atlanta');
                        self.simpleForm.state.$setViewValue('Georgia');
                        self.simpleForm.zip.$setViewValue('37013');
                        // now call $render() to update the model associated to each input
                        renderElement(['#city', '#state', '#zip']);
                    };

                });
    </script>
</head>

<body ng-controller="MyCtrl as myCtrl">
<div class='container'>
    <div class="row">
        <form name="myCtrl.simpleForm" class="form-horizontal" role="form" novalidate>
            <div class="form-group">
                <div ng-class="{'has-warning': myCtrl.simpleForm.city.$dirty}">
                    <label for="city" class="col-lg-2 control-label">
                        City
                        <span ng-show="myCtrl.simpleForm.city.$dirty">*</span>
                    </label>

                    <div class="col-lg-2">
                        <input type="text" class="form-control" id="city" name="city"
                               ng-model="myCtrl.location.city">
                    </div>
                </div>
            </div>
            <div class='form-group'>
                <div ng-class="{'has-warning': myCtrl.simpleForm.state.$dirty}">
                    <label for="state" class="col-lg-2 control-label">
                        State
                        <span ng-show="myCtrl.simpleForm.state.$dirty">*</span>
                    </label>
                    <div class="col-lg-2">
                        <input type="text" class="form-control" id="state" name="state"
                               ng-model="myCtrl.location.state">
                    </div>
                </div>

            </div>
            <div class='form-group'>
                <div ng-class="{'has-warning': myCtrl.simpleForm.zip.$dirty}">
                    <label for="zip" class="col-lg-2 control-label">
                        Zip
                        <span ng-show="myCtrl.simpleForm.zip.$dirty">*</span>
                    </label>
                    <div class="col-lg-2">
                        <input type="text" class="form-control" id="zip" name="zip" ng-model="myCtrl.location.zip">
                    </div>
                </div>

            </div>
            <div class='row'>
                <button type="button" class="btn btn-primary" ng-click='myCtrl.updateModel()'>Update Model</button>
            </div>
        </form>
    </div>
</div>
</body>

</html>
